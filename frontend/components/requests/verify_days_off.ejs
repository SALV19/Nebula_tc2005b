<script>
  document.addEventListener("DOMContentLoaded", function () { 
    const openBtn = document.getElementById("openRequestForm");
    const closeBtn = document.getElementById("closeRequestForm");
    const requestPopup = document.getElementById("requestPopup");
    const requestType = document.getElementById("requestType");
    const startDate = document.getElementById("startDate");
    const endDate = document.getElementById("endDate");
    const evidenceContainer = document.getElementById("evidenceContainer");
    
    // Verifica si los elementos existen
    if (!openBtn || !closeBtn || !requestPopup || !requestType || !startDate ||!evidenceContainer) {
        console.error("Error: No se encontraron los elementos del pop-up.");
        return;
    }

    // Abrir el formulario
    openBtn.addEventListener("click", () => {
        requestPopup.style.display = "flex";
    });

    // Cerrar el formulario
    closeBtn.addEventListener("click", () => {
        requestPopup.style.display = "none";
    });
  });

   // Funci칩n para contar d칤as h치biles (sin s치bados ni domingos)
    function weekendsoff(start, end) {
    let current = new Date(start);
    const endDate = new Date(end);
    let count = 0;

    while (current <= endDate) {
      const day = current.getDay(); // 0 = domingo, 6 = s치bado
      if (day !== 0 && day !== 6) {
        count++;
      }
      current.setDate(current.getDate() + 1);
    }

    return count;
  }

  // Mostrar o esconder el campo de evidencia
  function checkEvidenceRequirement() {
    const type = requestType.value;
    const start = startDate.value;
    const end = endDate.value;

    if (type === "Absence" && start && end) {
      const businessDays = weekendsoff(start, end);
      if (businessDays > 3) {
        evidenceContainer.style.display = "block";
        evidenceNote.style.display = "block"; // Muestra la leyenda
      } else {
        evidenceContainer.style.display = "none";
        evidenceNote.style.display = "none"; // Oculta si no aplic
      }
    } else {
      evidenceContainer.style.display = "none";
      evidenceNote.style.display = "none";
    }
  }

  // 游녤 Ejecutar checkEvidenceRequirement cuando cambian los campos
  requestType.addEventListener("change", checkEvidenceRequirement);
  startDate.addEventListener("change", checkEvidenceRequirement);
  endDate.addEventListener("change", checkEvidenceRequirement);

</script>