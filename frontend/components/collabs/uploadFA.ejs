<script>
    const form = document.querySelector("#form");
    const fileInput = document.querySelector("#drive_file");
    const csrf = document.querySelector("#_csrf").value;

    form.addEventListener("submit", async (e) => {
        e.preventDefault(); // Evita el reload de la pÃ¡gina

        const formData = new FormData(form);

        try {
        const response = await fetch("/view_collabs/uploadFA", {
            method: "POST",
            headers: {
                'csrf-token': csrf  
            },
            body: formData,
        });

        const result = await response.json();

        if (result.success) {
            Swal.fire({
            icon: "success",
            title: "Uploaded successfully",
            html: `
                <p><b>Name:</b> ${result.name}</p>
                <p><b>Type:</b> ${result.mimeType}</p>
                <p><b>ID:</b> ${result.fileId}</p>
                <br>
                <a href="${result.viewLink}" target="_blank" class="button is-link is-light">
                ðŸ”— Ver archivo en Drive
                </a>
                `,
            });
            form.reset(); // Limpia el formulario
        } else {
            Swal.fire({
            icon: "error",
            title: "Error al subir archivo",
            text: result.message || "Hubo un error inesperado.",
            });
        }
        } catch (error) {
        Swal.fire({
            icon: "error",
            title: "Fallo en el servidor",
            text: error.message,
        });
        }
    });
</script>