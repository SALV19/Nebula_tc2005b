<link rel="stylesheet" href="/css/home.css" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<%- include('../components/nav_bar.ejs') %>
<input type="hidden" id="_csrf" value=<%= csrfToken %></input>

<div class="columns">
  <div class="is-three-quarters">
    <div style="display: flex;">
    <button class="button is-link is-rounded" style="margin-left: auto;" onclick="openAddEventPopup()">+Add event</button>
    <%- include('includes/_addEvent_form.ejs') %>
    </div>
    <aside class="pop-up-d" style="display: none;" id="pop-up">
      <div class="pop-up-content-d">              
        <button onclick="closePopup()" class="button-close">
          <i class="bi bi-x"></i>
        </button>
        <div class="column-container">
          <div class="column2">
            <div id="color-calendar" class="calendar-color-box"></div>
            <h2 id="event-title" class="title-event"></h2>
          </div>                  
        </div>
        <p class="text-event"><strong>Date: </strong><span id="event-date"></span></p>
        <p class="text-event"><strong>Start Hour: </strong><span id="event-hour-start"></span></p>
        <p class="text-event"><strong>End Hour: </strong><span id="event-hour-end"></span></p>
        <p class="text-event"><strong>Details: </strong> <span id="event-details"></span></p>
      </div>
    </aside>
    <script>
      let eventos = <%- eventos %>; 
    </script>
    <%- include('../components/calendar/calendar.ejs') %> 
    <%- include ('../components/home/add_event_logic.ejs') %>
  </div>

  <div class="column column-counter">
    <%- include('../components/vacations_left.ejs') %>
    <% if (permissions?.includes('consult_rotation') && permissions?.includes('consult_metrics')) { %>
      <%- include('../components/current_absences.ejs', { total_days: total_absences }) %>
    <% } %>
  </div>
  <div class="column column-counters align-counter">
    <%- include('../components/current_absences.ejs', { total_days: total_absences }) %>
    <% if (permissions?.includes('consult_rotation') && permissions?.includes('consult_metrics')) { %>
      <%- include('../components/current_absences.ejs', { total_days: total_absences }) %>
    <% } %>
  </div>

</div>

<%- include('includes/_footer.ejs') %>
